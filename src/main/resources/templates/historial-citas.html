<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Historial de Citas - Sistema de Citas</title>
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
	<link th:href="@{/assets/css/historial-citas.css}" rel="stylesheet">
</head>

<body>

	<header class="header">
		<h1>Sistema de Citas</h1>
		<a href="/dashboard" class="back-button">← Volver al Dashboard</a>
	</header>

	<div class="container">
		<div class="card">
			<h2>📋 Historial de Citas</h2>

			<!-- Mensajes de éxito y error -->
			<div th:if="${success}" class="success-message" th:text="${success}"></div>
			<div th:if="${error}" class="error-message" th:text="${error}"></div>

			<div class="table-responsive">
				<table class="historial-table">
					<thead>
						<tr>
							<th>Servicio</th>
							<th>Profesional</th>
							<th>Fecha y Hora</th>
							<th>Estado</th>
							<th>Precio</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="cita : ${citas}">
							<td th:text="${cita?.servicio?.nombre ?: 'No especificado'}">Servicio</td>
							<td th:text="${cita?.profesional?.usuario?.nombre ?: 'No asignado'}">Profesional</td>
							<td
								th:text="${cita?.fechaHora != null ? #temporals.format(cita.fechaHora, 'dd/MM/yyyy HH:mm') : 'No definida'}">
								Fecha</td>
							<td>
								<span th:classappend="'status-badge ' + ${cita?.estado?.toLowerCase()}"
									th:text="${cita?.estado ?: 'PENDIENTE'}">Estado</span>
							</td>
							<td th:text="${cita?.servicio?.precio != null ? '$' + cita.servicio.precio : 'N/A'}">Precio
							</td>
						</tr>

						<tr th:if="${citas == null or citas.empty}">
							<td colspan="5" class="empty-state">
								📝 No hay citas en tu historial.
								<br><br>
								<button class="action-button" onclick="location.href='/citas/nueva'"
									style="padding: 10px 20px; font-size: 0.9em; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">
									¡Agenda tu primera cita!
								</button>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<script th:src="@{/assets/js/historial-citas.js}"></script>
</body>

</html>